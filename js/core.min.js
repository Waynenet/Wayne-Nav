function renderContent(){function e(e){const t=document.getElementById("main-menu");if(!t)return;const n=e.map(e=>{const t=e.id?"#"+e.id:"#"+e.title;if(e.children){const t=e.children.map(e=>{const t=e.id?"#"+e.id:"#"+e.title;return`<li><a href="${t}" class="smooth"><span class="title">${e.title}</span></a></li>`}).join("");return`<li><a><i class="${e.icon}"></i> <span class="title">${e.title}</span></a><ul>${t}</ul></li>`}return`<li><a href="${t}" class="smooth"><i class="${e.icon}"></i> <span class="title">${e.title}</span></a></li>`}).join("");t.innerHTML=n}function t(e){const t=document.getElementById("search-container");if(!e||!t)return;const{categoriesHTML:n,providersHTML:i}=e.reduce((e,t,n)=>{const i=0===n?"active":"";e.categoriesHTML+=`\n                    <div class="category-tab ${i}" data-category="${t.groupName}">${t.groupName}</div>`;const s=t.items.map(e=>`<div class="provider-item" data-id="${e.id}">${e.name}</div>`).join("");return e.providersHTML+=`\n                    <div class="provider-list ${i}" data-category-content="${t.groupName}">${s}</div>`,e},{categoriesHTML:"",providersHTML:""}),s=`\n            <div class="search-bar" id="search-bar">\n                <div class="selected-engine" id="selected-engine"></div>\n                <input type="text" id="search-text" autocomplete="off">\n                <button type="submit"><i class="ti ti-search"></i></button>\n            </div>\n            <div class="search-options-panel" id="search-options-panel">\n                <div class="search-categories">${n}</div>\n                <div class="search-providers">${i}</div>\n            </div>\n        `;t.innerHTML=s}function n(e){const t=document.getElementById("dynamic-content-container");if(!t)return;let n="";e.forEach(e=>{const t=e=>{if(!e.items)return"";const t=e.items.map(e=>{let t="images/browser.svg";try{const n=new URL(e.url).hostname;t=`https://api.xinac.net/icon/?url=${n}`}catch(e){}return`\n                        <div class="col-6 col-sm-6 col-md-4 col-lg-3 col-xl-2w col-xxl-2">\n                            <div class="w-widget box2" data-url="${e.url}" data-bs-toggle="tooltip" data-bs-placement="bottom" title="${e.url}">\n                                <div class="w-comment-entry">\n                                    <a><img data-src="${t}" class="lozad img-circle" onerror="this.onerror=null;this.src='images/browser.svg';"></a>\n                                    <div class="w-comment">\n                                        <a class="overflowClip_1"><strong>${e.title}</strong></a>\n                                        <p class="overflowClip_2">${e.description}</p>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>`}).join("");return`<h6 class="tag" id="${e.title}"><i class="ti ti-tag"></i>${e.title}</h6><div class="row">${t}</div><br />`};e.children?e.children.forEach(e=>{n+=t(e)}):n+=t(e)}),t.innerHTML=n}function i(e){const t={form:document.getElementById("super-search-fm"),container:document.getElementById("search-container"),bar:document.getElementById("search-bar"),input:document.getElementById("search-text"),engineDisplay:document.getElementById("selected-engine"),panel:document.getElementById("search-options-panel"),categoryTabsContainer:document.querySelector(".search-categories"),providerListsContainer:document.querySelector(".search-providers")};if(Object.values(t).some(e=>!e))return void console.error("关键搜索元素未在DOM中找到，无法绑定事件。");const n=new Map;e.forEach(e=>{e.items.forEach(e=>n.set(e.id,e))});const i=e=>{const s=n.get(e);if(s)t.input.placeholder=s.placeholder,t.form.action=s.url,t.engineDisplay.innerHTML=`<div class="icon-wrapper">${s.name}</div>`,t.panel.querySelectorAll(".provider-item").forEach(t=>{t.classList.toggle("selected",t.dataset.id===e)}),localStorage.setItem("searchEngineId",e);else{const e=n.values().next().value;e&&i(e.id)}};t.engineDisplay.addEventListener("click",e=>{t.panel.classList.toggle("active"),t.bar.classList.toggle("focused"),e.stopPropagation()}),document.addEventListener("click",e=>{t.container.contains(e.target)||(t.panel.classList.remove("active"),t.bar.classList.remove("focused"))}),t.panel.addEventListener("click",e=>{const n=e.target.closest(".category-tab");if(n){const e=n.dataset.category;t.categoryTabsContainer.querySelectorAll(".category-tab").forEach(e=>e.classList.remove("active")),n.classList.add("active"),t.providerListsContainer.querySelectorAll(".provider-list").forEach(t=>{t.classList.toggle("active",t.dataset.categoryContent===e)})}const s=e.target.closest(".provider-item");s&&(i(s.dataset.id),t.input.focus(),t.panel.classList.remove("active"),t.bar.classList.remove("focused"))}),t.form.addEventListener("submit",e=>{e.preventDefault();const n=t.input.value.trim();if(n){const e=`${t.form.action}${encodeURIComponent(n)}`;window.open(e,"_blank")}});const s=localStorage.getItem("searchEngineId");if(s&&n.has(s)){i(s);n.get(s);const t=e.find(e=>e.items.some(e=>e.id===s));if(t){const e=document.querySelector(`.category-tab[data-category="${t.groupName}"]`);e&&e.click()}}else{const e=n.values().next().value;if(e){i(e.id);const t=document.querySelector(".category-tab");t&&t.click()}}}function s(){if("function"==typeof lozad){const e=lozad();e.observe()}if("undefined"!=typeof bootstrap){const e=Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]'));e.forEach(e=>{new bootstrap.Tooltip(e)})}}fetch("js/data.json").then(e=>{if(!e.ok)throw new Error(`HTTP 错误！状态: ${e.status}. 无法加载 'js/data.json'`);return e.json()}).then(o=>{if(!o||!o.pageData)throw new Error("JSON 数据格式不正确或缺少必要的配置部分。");const a=o.pageData.find(e=>"search"===e.id),r=a?a.searchConfig:null;if(!r)throw new Error("在 pageData 中未找到有效的 searchConfig。");e(o.pageData),n(o.pageData),t(r),i(r),s(),setupSidebarMenu(),setupSidebarToggles()}).catch(e=>{console.error("严重错误:",e);const t=document.getElementById("dynamic-content-container");t&&(t.innerHTML='<p style="text-align: center; color: red;">加载内容失败！请按F12查看控制台中的详细错误信息。</p>')})}function initializePageFunctions(){Object.assign(public_vars,{$body:document.body,$pageContainer:document.querySelector(".page-container"),$sidebarMenu:document.querySelector(".sidebar-menu"),$mainMenu:document.querySelector(".main-menu"),$mainContent:document.querySelector(".main-content"),$userInfoMenu:document.querySelector("nav.user-info-navbar")}),setupBackToTop(),setupMousePointer(),setupDarkMode(),setupStarfield(),setupBgImageFallback(),setupAppearanceSettings(),setupFooterInfo();const e=document.getElementById("dynamic-content-container");e&&e.addEventListener("click",function(e){const t=e.target.closest(".w-widget.box2");t&&t.dataset.url&&window.open(t.dataset.url,"_blank")})}function setupBackToTop(){const e=document.getElementById("topup"),t=document.querySelector(".sidebar-menu-inner");if(e){window.addEventListener("scroll",function(){window.scrollY>=50?(e.style.display="block",e.style.opacity="1",t&&t.classList.remove("bgchange")):(e.style.opacity="0",e.addEventListener("transitionend",()=>{window.scrollY<50&&(e.style.display="none")},{once:!0}),t&&t.classList.add("bgchange"))});const n=document.querySelector('a[rel="go-top"]');n&&n.addEventListener("click",function(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})}}function setupMousePointer(){const e=document.body,t=document.getElementById("pointer");if(t){const i=t.offsetWidth/2;function n(e,n){t.style.transform=`translate(${e-i+19}px, ${n-i+19}px)`}e.addEventListener("mousemove",e=>{window.requestAnimationFrame(()=>n(e.clientX,e.clientY))})}/Mobi|Tablet|iPad|iPhone|Android/i.test(navigator.userAgent)&&t&&(t.style.display="none")}function setupDarkMode(){const e=e=>localStorage.getItem(e),t=(e,t)=>localStorage.setItem(e,t),n=e=>{const n=document.getElementById("night-mode-tooltip"),i=e?"已切换为夜间模式":"已切换为日间模式",s=e?"ti ti-moon-filled":"ti ti-sun-filled",o=e?"夜间模式切换":"日间模式切换";e?(document.body.classList.add("night"),t("night","1"),n&&(n.innerText="切换日间模式")):(document.body.classList.remove("night"),t("night","0"),n&&(n.innerText="切换夜间模式")),"undefined"!=typeof iziToast&&iziToast.info({timeout:2e3,closeOnEscape:!0,transitionOut:"fadeOutRight",displayMode:"replace",layout:2,transitionIn:"bounceInLeft",position:"topRight",icon:s,backgroundColor:"#fff",title:o,message:i})},i=()=>{const t="0"===e("night");n(t)},s=document.getElementById("dark-mode-switch");s&&s.addEventListener("click",e=>{e.preventDefault(),i()});const o=()=>{const e=(new Date).getHours();return e>18||e<7};window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>n(e.matches));const a=e("night");n(null===a?o():"1"===a)}function setupStarfield(){function e(){function e(e){return 1e3*Math.random()<10*e}function t(e,t){return Math.random()*(t-e)+e}function n(){r=window.innerWidth,c=window.innerHeight,o.width=r,o.height=c}function i(){a.clearRect(0,0,r,c);for(let e of l)e.move(),e.fadeIn(),e.fadeOut(),e.draw();requestAnimationFrame(i)}function s(){n(),l=Array.from({length:u},()=>new p),i(),setTimeout(()=>d=!1,50)}const o=document.getElementById("starfield");if(!o)return;const a=o.getContext("2d");let r=window.innerWidth,c=window.innerHeight,l=[],d=!0;const u=Math.floor(.3*r),m={giant:"180,184,240",star:"226,225,142",comet:"225,225,225"};class p{constructor(){this.reset()}reset(){this.isGiant=e(3),this.isComet=!this.isGiant&&!d&&e(20),this.x=t(0,r),this.y=t(0,c),this.size=t(1.1,2.6),this.dx=t(.05,.3)+(this.isComet?t(2.5,6):.05),this.dy=-t(.05,.3)-(this.isComet?t(2.5,6):.05),this.opacity=0,this.opacityTarget=t(.6,this.isComet?.8:1),this.fadeSpeed=t(5e-4,.002)+(this.isComet?.001:0),this.fadingIn=!0,this.fadingOut=!1}fadeIn(){this.fadingIn&&(this.opacity+=this.fadeSpeed,this.opacity>=this.opacityTarget&&(this.fadingIn=!1))}fadeOut(){this.fadingOut&&(this.opacity-=this.fadeSpeed/2,this.opacity<=0&&this.reset())}move(){this.x+=this.dx,this.y+=this.dy,!this.fadingOut&&(this.x>r-r/4||this.y<0)&&(this.fadingOut=!0)}draw(){if(a.beginPath(),this.isGiant)a.fillStyle=`rgba(${m.giant},${this.opacity})`,a.arc(this.x,this.y,2,0,2*Math.PI);else if(this.isComet){a.fillStyle=`rgba(${m.comet},${this.opacity})`,a.arc(this.x,this.y,1.5,0,2*Math.PI);for(let e=0;e<30;e++)a.fillStyle=`rgba(${m.comet},${this.opacity-this.opacity/20*e})`,a.fillRect(this.x-this.dx/4*e,this.y-this.dy/4*e-2,2,2)}else a.fillStyle=`rgba(${m.star},${this.opacity})`,a.fillRect(this.x,this.y,this.size,this.size);a.closePath(),a.fill()}}window.addEventListener("resize",n),s()}e()}function setupBgImageFallback(){const e=document.body,t=window.getComputedStyle(e).backgroundImage.match(/url\("?(.+?)"?\)/);if(!t)return;const n=t[1],i=new Image;i.src=n,i.onerror=(()=>{e.style.background="#3f5d5c",e.style.backgroundImage="none",console.warn("背景图片加载失败，已设置为纯色背景")})}function setupSidebarMenu(){function e(e,t){if("true"===e.dataset.isBusy)return;e.dataset.isBusy="true",e.classList.add("expanded"),t.style.display="block";const n=Array.from(t.children),i=gsap.timeline({onComplete:()=>{gsap.set(t,{height:"auto",overflow:"visible"}),e.dataset.isBusy="false"}});t.scrollHeight;i.from(t,{height:0,autoAlpha:1,duration:.3,ease:"power2.out"}),i.from(n,{autoAlpha:0,x:-15,duration:.2,ease:"power2.out",stagger:.05},"-=0.25")}function t(e,t){if("true"===e.dataset.isBusy)return;e.dataset.isBusy="true",e.classList.remove("expanded");const n=Array.from(t.children),i=gsap.timeline({onComplete:()=>{gsap.set([t,...n],{clearProps:"all"}),e.classList.remove("opened"),e.dataset.isBusy="false"}});i.to(n,{autoAlpha:0,x:-10,duration:.15,ease:"power2.in",stagger:.03}),i.to(t,{height:0,autoAlpha:1,duration:.25,ease:"power2.in"},"-=0.2")}const{$sidebarMenu:n}=public_vars;if(!n)return;const i=n.classList.contains("toggle-others"),s=Array.from(n.querySelectorAll("li")).filter(e=>e.querySelector(":scope > ul"));s.forEach(s=>{const o=s.querySelector(":scope > a"),a=s.querySelector(":scope > ul");s.classList.add("has-sub"),o.addEventListener("click",o=>{if(!n.classList.contains("collapsed")){if(o.preventDefault(),i){const e=Array.from(s.parentElement.children).filter(e=>e!==s&&e.classList.contains("expanded"));e.forEach(e=>{const n=e.querySelector(":scope > ul");n&&t(e,n)})}s.classList.contains("expanded")?t(s,a):e(s,a)}})})}function setupSidebarToggles(){function e(e){if(i)switch(e){case"largescreen":i.classList.remove("collapsed");break;case"tabletscreen":i.classList.add("collapsed")}}function t(){const e=window.innerWidth;for(const t in public_vars.breakpoints){let[n,i]=public_vars.breakpoints[t];if(-1===i&&(i=1/0),e>=n&&e<=i)return t}return null}function n(){const n=t();public_vars.lastBreakpoint!==n&&(public_vars.lastBreakpoint=n,e(n))}const{$sidebarMenu:i,$mainMenu:s,$pageContainer:o,$userInfoMenu:a}=public_vars;if(document.querySelectorAll('a[data-toggle="sidebar"]').forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),i&&i.classList.toggle("collapsed")})}),document.querySelectorAll('a[data-toggle="mobile-menu"]').forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),s&&s.classList.toggle("mobile-is-visible"),i&&i.classList.toggle("mobile-is-visible"),o&&o.classList.toggle("mobile-is-visible")})}),document.querySelectorAll('a[data-toggle="user-info-menu"]').forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),a&&a.classList.toggle("mobile-is-visible")})}),a){const e=a.offsetHeight-1;a.querySelectorAll(".user-info-menu > li").forEach(t=>{t.style.minHeight=`${e}px`})}document.addEventListener("click",function(e){if(e.target.closest(".has-sub")){const t=e.target.closest(".has-sub");if(!t.classList.contains("expanded")){const e=t.querySelector("ul");e&&e.removeAttribute("style")}}}),document.querySelectorAll(".user-info-menu .d-none").forEach(e=>{e.addEventListener("click",()=>{i&&i.classList.contains("collapsed")?document.querySelectorAll(".has-sub.expanded > ul").forEach(e=>e.removeAttribute("style")):document.querySelectorAll(".has-sub.expanded > ul").forEach(e=>e.style.display="block")})}),document.querySelectorAll("#main-menu li ul li").forEach(e=>{e.addEventListener("click",function(){Array.from(this.parentElement.children).forEach(e=>e.classList.remove("active")),this.classList.add("active")})}),document.querySelectorAll("a.smooth").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("href"),n=document.querySelector(t);if(!n)return;const a=n.offsetTop-30;document.querySelectorAll("#main-menu li").forEach(e=>e.classList.remove("active")),this.parentElement.classList.add("active"),s&&s.classList.remove("mobile-is-visible"),i&&i.classList.remove("mobile-is-visible"),o&&o.classList.remove("mobile-is-visible"),window.scrollTo({top:a,behavior:"smooth"})})}),window.addEventListener("resize",n),window.addEventListener("orientationchange",n),n()}function setupAppearanceSettings(){const e=document.documentElement,t=document.getElementById("settings-container"),n=["alpha-slider","overlay-slider"];if(!t)return void console.warn("外观设置控件容器未找到，功能禁用。");const i={"overlay-slider":{variable:"--overlay-opacity",defaults:{light:.4,night:0},unit:""},"blur-slider":{variable:"--module-blur-value",defaults:{light:12,night:0},unit:"px"},"alpha-slider":{variable:"--module-bg-alpha",defaults:{light:.1,night:.15},unit:""}},s=()=>document.body.classList.contains("night")?"night":"light",o=()=>{const t=s();Object.values(i).forEach(i=>{const s=document.querySelector(`.control-slider[data-variable="${i.variable}"]`);if(!s)return;const o=`${i.variable}-${t}`,a=localStorage.getItem(o),r=i.defaults[t],c=null!==a?a:r;if(e.style.setProperty(i.variable,c+i.unit),s.value=c,s.nextElementSibling){const e=n.includes(s.id)?2:0;s.nextElementSibling.textContent=parseFloat(c).toFixed(e)}})};t.addEventListener("click",function(e){const t=e.target.closest(".suspension_box");if(t){if(e.stopPropagation(),"settings-toggle"===t.id)return this.classList.toggle("open"),void(this.classList.contains("open")||(this.querySelectorAll(".control-slider-panel.visible").forEach(e=>e.classList.remove("visible")),this.classList.remove("hide-tooltips")));if(t.classList.contains("suspension_control")){const e=document.getElementById(`${t.dataset.control}-panel`);if(!e)return;const n=e.classList.contains("visible");this.querySelectorAll(".control-slider-panel").forEach(e=>e.classList.remove("visible")),n||e.classList.add("visible");const i=null!==this.querySelector(".control-slider-panel.visible");this.classList.toggle("hide-tooltips",i)}}}),document.querySelectorAll(".control-slider").forEach(t=>{t.addEventListener("input",function(){const t=this.dataset.variable,i=this.dataset.unit,o=this.value;if(e.style.setProperty(t,o+i),this.nextElementSibling){const e=n.includes(this.id)?2:0;this.nextElementSibling.textContent=parseFloat(o).toFixed(e)}const a=`${t}-${s()}`;localStorage.setItem(a,o)}),t.closest(".control-slider-panel").addEventListener("click",e=>e.stopPropagation())}),document.addEventListener("click",function(){t.classList.contains("open")&&(t.classList.remove("open","hide-tooltips"),t.querySelectorAll(".control-slider-panel.visible").forEach(e=>e.classList.remove("visible")))}),new MutationObserver(()=>{o()}).observe(document.body,{attributes:!0,attributeFilter:["class"]}),o()}function setupFooterInfo(){function e(){clearTimeout(t);const n=new Date,i=["日","一","二","三","四","五","六"],s=n.getHours().toString().padStart(2,"0"),o=n.getMinutes().toString().padStart(2,"0"),a=n.getSeconds().toString().padStart(2,"0"),r=document.getElementById("times");r&&(r.innerHTML=`${n.getFullYear()}.${n.getMonth()+1}.${n.getDate()} <span class='weekday'>星期${i[n.getDay()]}</span><br/><span class='time-text'>${s}:${o}:${a}</span>`),t=setTimeout(e,1e3)}fetch("https://api.vvhan.com/api/weather").then(e=>e.json()).then(e=>{const t=document.getElementById("wea_text"),n=document.getElementById("city_text"),i=document.getElementById("tem_low"),s=document.getElementById("tem_high"),o=document.getElementById("win_text"),a=document.getElementById("win_speed");t&&(t.innerHTML=e.data.type),n&&(n.innerHTML=e.city),i&&(i.innerHTML=e.data.low),s&&(s.innerHTML=e.data.high),o&&(o.innerHTML=e.data.fengxiang),a&&(a.innerHTML=e.data.fengli)}).catch(console.error);let t=null;e();const n=document.getElementById("time");n&&performance.now()&&(n.innerHTML=` 页面加载耗时 ${Math.round(performance.now())} 毫秒 `),fetch("/cdn-cgi/trace").then(e=>e.text()).then(e=>{const t=Object.fromEntries(e.trim().split("\n").map(e=>e.split("="))),n=document.getElementById("result");n&&(n.innerHTML=`节点:${t.colo} | 访客:${t.loc} | IP:${t.ip}`)}),console.clear(),console.log("%cWayneのNav %c\n==============================\n#   #    #   #   # #   # #####\n#   #   # #   # #  ##  # #\n# # #  #####   #   # # # #####\n## ##  #   #   #   #  ## #\n#   #  #   #   #   #   # #####\n==============================\n %c\n版 本 号：v7.0.0\n更新日期：2025-08-11\n\nWayneのNav: https://nav.3301.qzz.io/\nGithub:  https://github.com/Waynenet/Wayne-Nav\n","font-size: 20px; font-weight: 600; color: rgb(244,167,89);","font-size: 16px; color: rgb(244,167,89);","color: rgb(30,152,255);")}const public_vars={$body:null,$pageContainer:null,$sidebarMenu:null,$mainMenu:null,$mainContent:null,$userInfoMenu:null,breakpoints:{largescreen:[991,-1],tabletscreen:[768,990],devicescreen:[420,767],sdevicescreen:[0,419]},lastBreakpoint:null};document.addEventListener("DOMContentLoaded",function(){renderContent(),initializePageFunctions()});